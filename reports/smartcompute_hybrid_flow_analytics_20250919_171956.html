
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartCompute Industrial - Dashboard Híbrido Avanzado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 50%, #2980b9 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .process-flow-map {
            position: relative;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            border-radius: 15px;
            height: 500px;
            overflow: auto;
            padding: 20px;
        }
        .process-node {
            position: absolute;
            width: 120px;
            height: 80px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 8px;
            font-size: 0.7rem;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .process-node:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            z-index: 10;
        }
        .process-node.selected {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.3);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        .process-node.input {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4CAF50;
        }
        .process-node.process {
            background: rgba(33, 150, 243, 0.3);
            border-color: #2196F3;
        }
        .process-node.utility {
            background: rgba(156, 39, 176, 0.3);
            border-color: #9C27B0;
        }
        .connection-line {
            position: absolute;
            height: 4px;
            background: linear-gradient(90deg, rgba(52,152,219,0.4), rgba(52,152,219,0.9), rgba(52,152,219,0.4));
            border-radius: 2px;
            transform-origin: left center;
            animation: flow 3s infinite;
            z-index: 1;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .connection-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 10px solid rgba(52,152,219,0.9);
            border-top: 7px solid transparent;
            border-bottom: 7px solid transparent;
            z-index: 2;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));
        }
        .chart-container {
            position: relative;
            height: 350px;
            margin: 15px 0;
        }
        .metric-card {
            transition: transform 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px);
        }
        .mle-recommendation {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #FFC107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .severity-high { border-left-color: #dc3545; }
        .severity-medium { border-left-color: #ffc107; }
        .severity-low { border-left-color: #28a745; }
        @keyframes flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="glass-card p-4 text-center">
                    <h1 class="text-white display-4 mb-3">
                        <i class="fas fa-industry me-3"></i>
                        SmartCompute Industrial - Dashboard Híbrido
                    </h1>
                    <h2 class="text-white mb-3">
                        Diagrama de Flujo + Analytics + MLE Star
                    </h2>
                    <div class="row text-white">
                        <div class="col-md-4">
                            <i class="fas fa-clock me-2"></i>
                            <strong>Actualizado:</strong> 2025-09-19 17:19:56
                        </div>
                        <div class="col-md-4">
                            <i class="fas fa-mouse-pointer me-2"></i>
                            <strong>Click en proceso</strong> para análisis detallado
                        </div>
                        <div class="col-md-4">
                            <i class="fas fa-robot me-2"></i>
                            <strong>MLE Star</strong> analiza cada área
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Process Flow Map -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="glass-card p-4">
                    <h5 class="text-white mb-3">
                        <i class="fas fa-project-diagram me-2"></i>
                        Diagrama de Flujo de Procesos Industriales
                        <span class="badge bg-info ms-2" id="selectedProcessBadge">Seleccione un proceso</span>
                    </h5>
                    <div class="process-flow-map" id="processFlowMap">
                        <div class="process-node input warning"
                             style="left: 50px; top: 100px;"
                             onclick="selectProcess('raw_materials')"
                             data-node-id="raw_materials"
                             id="node_raw_materials">
                            <div class="node-icon">
                                <i class="fas fa-boxes"></i>
                            </div>
                            <div class="node-name">Materias Primas</div>
                            <div class="node-status">1 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 93%"></div>
                            </div>
                        </div>
                        <div class="process-node process operational"
                             style="left: 200px; top: 100px;"
                             onclick="selectProcess('quality_control_in')"
                             data-node-id="quality_control_in"
                             id="node_quality_control_in">
                            <div class="node-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="node-name">Control de Calidad Entrada</div>
                            <div class="node-status">0 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 96%"></div>
                            </div>
                        </div>
                        <div class="process-node process critical"
                             style="left: 350px; top: 100px;"
                             onclick="selectProcess('preparation')"
                             data-node-id="preparation"
                             id="node_preparation">
                            <div class="node-icon">
                                <i class="fas fa-blender"></i>
                            </div>
                            <div class="node-name">Preparación y Mezclado</div>
                            <div class="node-status">3 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 89%"></div>
                            </div>
                        </div>
                        <div class="process-node process warning"
                             style="left: 500px; top: 50px;"
                             onclick="selectProcess('thermal_treatment')"
                             data-node-id="thermal_treatment"
                             id="node_thermal_treatment">
                            <div class="node-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="node-name">Tratamiento Térmico</div>
                            <div class="node-status">2 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 87%"></div>
                            </div>
                        </div>
                        <div class="process-node utility warning"
                             style="left: 800px; top: 250px;"
                             onclick="selectProcess('power_distribution')"
                             data-node-id="power_distribution"
                             id="node_power_distribution">
                            <div class="node-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="node-name">Distribución Eléctrica</div>
                            <div class="node-status">1 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 97%"></div>
                            </div>
                        </div>
                        <div class="process-node process critical"
                             style="left: 1100px; top: 100px;"
                             onclick="selectProcess('packaging')"
                             data-node-id="packaging"
                             id="node_packaging">
                            <div class="node-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="node-name">Empaquetado</div>
                            <div class="node-status">3 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 93%"></div>
                            </div>
                        </div>
                        <div class="connection-line"
                             style="left: 170px;
                                    top: 138.5px;
                                    width: 18.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-arrow"
                             style="left: 182.0px;
                                    top: 134.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-line"
                             style="left: 320px;
                                    top: 138.5px;
                                    width: 18.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-arrow"
                             style="left: 332.0px;
                                    top: 134.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-line"
                             style="left: 470px;
                                    top: 138.5px;
                                    width: 46.309518948453004px;
                                    transform: rotate(-59.03624346792648deg);">
                        </div>
                        <div class="connection-arrow"
                             style="left: 487.82605093486967px;
                                    top: 94.28991510855053px;
                                    transform: rotate(-59.03624346792648deg);">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Section (Initially Hidden) -->
        <div class="row mb-4" id="analyticsSection" style="display: none;">
            <div class="col-12">
                <div class="glass-card p-4">
                    <h5 class="text-white mb-3" id="analyticsTitle">
                        <i class="fas fa-chart-line me-2"></i>
                        Análisis Detallado del Proceso
                    </h5>

                    <!-- Process KPIs -->
                    <div class="row mb-4" id="processKPIs">
                        <!-- Will be populated by JavaScript -->
                    </div>

                    <!-- Charts Row -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="glass-card p-4">
                                <h6 class="text-white mb-3">
                                    <i class="fas fa-chart-area me-2"></i>
                                    Tendencias de Rendimiento (24h)
                                </h6>
                                <div class="chart-container">
                                    <canvas id="performanceChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="glass-card p-4">
                                <h6 class="text-white mb-3">
                                    <i class="fas fa-tachometer-alt me-2"></i>
                                    Métricas en Tiempo Real
                                </h6>
                                <div class="chart-container">
                                    <canvas id="realtimeChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Network and Sensors Details -->
                    <div class="row mb-4" id="technicalDetails">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- MLE Star Analysis Section -->
        <div class="row mb-4" id="mleSection" style="display: none;">
            <div class="col-12">
                <div class="glass-card p-4">
                    <h5 class="text-white mb-3">
                        <i class="fas fa-robot me-2"></i>
                        Análisis MLE Star - Recomendaciones Específicas
                        <button class="btn btn-sm btn-outline-success ms-2" onclick="runMLEAnalysis()">
                            <i class="fas fa-play"></i> Ejecutar Análisis
                        </button>
                    </h5>
                    <div id="mleRecommendations">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="row">
            <div class="col-12">
                <div class="glass-card p-3 text-center">
                    <small class="text-white">
                        SmartCompute Industrial - Dashboard Híbrido |
                        <a href="mailto:ggwre04p0@mozmail.com" class="text-info">ggwre04p0@mozmail.com</a> |
                        <a href="https://www.linkedin.com/in/martín-iribarne-swtf/" class="text-info" target="_blank">LinkedIn</a>
                    </small>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos del sistema
        const systemData = {
        "timestamp": "2025-09-19 17:19:56.661598",
        "system_health": {
                "overall_score": 86.95619288576918,
                "cpu_usage": 12.800685585997888,
                "memory_usage": 64.01286990926637,
                "temperature": 38.392365921011134,
                "uptime_hours": 7505
        },
        "process_flow": {
                "raw_materials": {
                        "id": "raw_materials",
                        "name": "Materias Primas",
                        "type": "input",
                        "icon": "fas fa-boxes",
                        "status": "operational",
                        "alerts": 1,
                        "personnel": 3,
                        "throughput": 93.43433518282175,
                        "connections": [
                                "quality_control_in"
                        ],
                        "position": {
                                "x": 50,
                                "y": 100
                        },
                        "sensors": {
                                "weight_scales": [
                                        {
                                                "id": "WS-001",
                                                "type": "B\u00e1scula Industrial",
                                                "value": 8.08603036200875,
                                                "unit": "Ton",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "WS-002",
                                                "type": "B\u00e1scula de Precisi\u00f3n",
                                                "value": 1742.5609344459654,
                                                "unit": "kg",
                                                "status": "NORMAL"
                                        }
                                ],
                                "inventory": [
                                        {
                                                "id": "INV-001",
                                                "material": "Acero Inoxidable 316L",
                                                "quantity": 92.17897128119637,
                                                "unit": "%",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "INV-002",
                                                "material": "Pol\u00edmero PET",
                                                "quantity": 68.86159541432775,
                                                "unit": "%",
                                                "status": "WARNING"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-100-RAW",
                                "subnet": "192.168.100.0/24",
                                "devices": 12,
                                "bandwidth_usage": 28.490041473622025,
                                "security_level": "HIGH"
                        },
                        "metrics_data": {
                                "throughput_history": [
                                        87.95404420570023,
                                        94.27496177839791,
                                        90.00808996104465,
                                        94.72664448281309,
                                        81.58025221133033,
                                        83.94481747003874,
                                        90.46022076223815,
                                        85.04269705967177,
                                        92.6652301752703,
                                        86.87659961843154,
                                        90.45120593709085,
                                        90.2062061729199,
                                        88.7312840114473,
                                        87.14408354768536,
                                        91.99656843470223,
                                        94.69329839701855,
                                        87.48129624144622,
                                        85.63879346980252,
                                        88.62161428446764,
                                        94.24939377200397,
                                        84.31202532922067,
                                        93.42023454045923,
                                        86.88164450986025,
                                        90.72573041554345
                                ],
                                "inventory_levels": [
                                        77.31077716087323,
                                        77.95738561916293,
                                        88.28144020349937,
                                        77.81973035369283,
                                        86.63853552622284,
                                        94.44125202055638,
                                        77.55856627291146,
                                        82.72579121181111,
                                        70.90589626195622,
                                        89.31856332955226,
                                        94.43882361494309,
                                        86.9205586970344,
                                        88.26479348148176,
                                        88.3620615273723,
                                        80.43930318591038,
                                        76.7032463815626,
                                        79.49981670401652,
                                        86.50461730646619,
                                        72.65786409169198,
                                        88.85572541460817,
                                        73.77974090807741,
                                        82.94222918794419,
                                        84.92039230228121,
                                        90.05860855108723
                                ],
                                "quality_scores": [
                                        97.64479397965785,
                                        98.27504670662236,
                                        95.09768899176792,
                                        93.75809310964934,
                                        96.3136744686901,
                                        98.03444201679355,
                                        96.86936780664848,
                                        95.58091566348129,
                                        97.67384847035142,
                                        96.11912718786606,
                                        96.20617980805763,
                                        96.51362045851307,
                                        92.62236894508735,
                                        92.89688587081801,
                                        93.1330057566865,
                                        96.90480859475329,
                                        93.60165057229074,
                                        96.68234071344456,
                                        94.64210093754464,
                                        98.46657728722931,
                                        95.87731691628996,
                                        96.09572702835924,
                                        94.01229957739906,
                                        97.5148078991107
                                ]
                        }
                },
                "quality_control_in": {
                        "id": "quality_control_in",
                        "name": "Control de Calidad Entrada",
                        "type": "process",
                        "icon": "fas fa-search",
                        "status": "operational",
                        "alerts": 0,
                        "personnel": 4,
                        "throughput": 96.24052680199587,
                        "connections": [
                                "preparation"
                        ],
                        "position": {
                                "x": 200,
                                "y": 100
                        },
                        "sensors": {
                                "sampling": [
                                        {
                                                "id": "SAMP-001",
                                                "type": "Muestreador Autom\u00e1tico",
                                                "samples_hour": 17,
                                                "status": "OPERATIONAL"
                                        },
                                        {
                                                "id": "SAMP-002",
                                                "type": "Analizador Espectral",
                                                "accuracy": 99.08162091303076,
                                                "unit": "%",
                                                "status": "OPERATIONAL"
                                        }
                                ],
                                "compliance": [
                                        {
                                                "standard": "ISO 9001:2015",
                                                "compliance": 98.80770929291769,
                                                "last_audit": "2025-09-15"
                                        },
                                        {
                                                "standard": "FDA 21 CFR 11",
                                                "compliance": 97.89939976051382,
                                                "incidents": 2
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-110-QC",
                                "subnet": "192.168.110.0/24",
                                "devices": 18,
                                "bandwidth_usage": 49.022605092085634,
                                "security_level": "CRITICAL"
                        },
                        "metrics_data": {
                                "sample_processing": [
                                        24,
                                        22,
                                        22,
                                        25,
                                        18,
                                        28,
                                        26,
                                        25,
                                        26,
                                        28,
                                        23,
                                        25,
                                        20,
                                        21,
                                        23,
                                        20,
                                        23,
                                        23,
                                        26,
                                        25,
                                        26,
                                        28,
                                        23,
                                        27
                                ],
                                "compliance_scores": [
                                        96.00891636113523,
                                        94.33901289666595,
                                        98.88960941989784,
                                        95.80416807467789,
                                        97.85914684669365,
                                        95.63270091855833,
                                        94.26296200812746,
                                        99.22356652517323,
                                        98.53004289300456,
                                        94.60177445111816,
                                        97.78385436731,
                                        98.29484842026076,
                                        98.97235065956262,
                                        96.244202550622,
                                        96.13625062701405,
                                        99.08767659023579,
                                        98.35231671949484,
                                        99.00620998780381,
                                        97.60889475060965,
                                        98.02431261121869,
                                        96.44293104114944,
                                        98.97922890148703,
                                        96.50569166481748,
                                        98.63881280621595
                                ],
                                "rejection_rates": [
                                        1.0422914358172835,
                                        2.0944660100066224,
                                        2.402885152225633,
                                        0.4763650830948547,
                                        1.212631413096246,
                                        0.9644774654166194,
                                        1.915046124364302,
                                        2.3824006550869314,
                                        0.6944899441016424,
                                        1.600949166826331,
                                        2.3299053591134897,
                                        1.4855184817816347,
                                        0.9256993781899477,
                                        1.176590926785546,
                                        0.6125905120879461,
                                        2.444760574802567,
                                        0.775376018695511,
                                        0.6440047131921589,
                                        2.3956160114892184,
                                        1.6227788591726517,
                                        0.5869229089964215,
                                        1.5815158492044321,
                                        1.631782081613622,
                                        1.0483045558252813
                                ]
                        }
                },
                "preparation": {
                        "id": "preparation",
                        "name": "Preparaci\u00f3n y Mezclado",
                        "type": "process",
                        "icon": "fas fa-blender",
                        "status": "operational",
                        "alerts": 3,
                        "personnel": 5,
                        "throughput": 89.34307779400042,
                        "connections": [
                                "thermal_treatment",
                                "quality_control_process"
                        ],
                        "position": {
                                "x": 350,
                                "y": 100
                        },
                        "sensors": {
                                "mixing_parameters": [
                                        {
                                                "id": "MIX-001",
                                                "parameter": "Velocidad de Mezclado",
                                                "value": 200.9170317002708,
                                                "unit": "RPM",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "MIX-002",
                                                "parameter": "Presi\u00f3n de Mezclado",
                                                "value": 2.8675794020645933,
                                                "unit": "bar",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "MIX-003",
                                                "parameter": "Temperatura de Mezcla",
                                                "value": 74.39653729603828,
                                                "unit": "\u00b0C",
                                                "status": "WARNING"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-120-PREP",
                                "subnet": "192.168.120.0/24",
                                "devices": 25,
                                "bandwidth_usage": 65.52017716979174,
                                "security_level": "HIGH"
                        },
                        "metrics_data": {
                                "mixing_efficiency": [
                                        92.91633828290314,
                                        85.8774845847689,
                                        88.69766675512189,
                                        90.43558803938785,
                                        92.57753102325414,
                                        94.8162897625341,
                                        93.94324509826497,
                                        85.22197624559894,
                                        85.67010397052326,
                                        92.06306868369462,
                                        89.44800237789632,
                                        94.85547869028215,
                                        90.90442388019282,
                                        92.51590375390766,
                                        92.03522473860174,
                                        87.81973331887123,
                                        88.64521102721439,
                                        86.03277876556348,
                                        89.89682208697437,
                                        91.14529101745548,
                                        88.67724483623905,
                                        86.61782278639996,
                                        90.82825593449544,
                                        85.90362481560567
                                ],
                                "temperature_profile": [
                                        69.26871172085833,
                                        77.7279875685004,
                                        69.58384214106368,
                                        75.44026155056008,
                                        68.30419377634607,
                                        71.66422059439903,
                                        69.62434341504667,
                                        70.07031487091528,
                                        75.68553111708546,
                                        77.63514564120732,
                                        75.67589403295419,
                                        69.81159475500078,
                                        72.37831273098524,
                                        71.37750897900361,
                                        75.01795572492881,
                                        73.85141554408506,
                                        69.95454739563444,
                                        71.28197547101017,
                                        74.75223055776243,
                                        77.01280418715255,
                                        69.03710530744709,
                                        75.70585681108373,
                                        70.4130092286629,
                                        70.65846900219204
                                ],
                                "pressure_stability": [
                                        3.130436152980454,
                                        3.702614283465761,
                                        3.2722769710147244,
                                        3.2183754160012894,
                                        3.0861261113365446,
                                        2.502711398290751,
                                        2.77373431773139,
                                        2.656680252151824,
                                        3.364221807515703,
                                        2.823858795305832,
                                        3.2405017780622414,
                                        2.6868126947139146,
                                        3.067476314559424,
                                        3.4442645356392667,
                                        3.305968547621776,
                                        3.262718108526778,
                                        2.6245137887267065,
                                        2.9748814343941854,
                                        3.2990404385479875,
                                        2.8222487395825615,
                                        3.0184518405449325,
                                        3.6877951030182183,
                                        3.6818087442598744,
                                        3.3186730043748285
                                ]
                        }
                },
                "thermal_treatment": {
                        "id": "thermal_treatment",
                        "name": "Tratamiento T\u00e9rmico",
                        "type": "process",
                        "icon": "fas fa-fire",
                        "status": "warning",
                        "alerts": 2,
                        "personnel": 8,
                        "throughput": 86.6460884880601,
                        "connections": [
                                "cooling",
                                "energy_recovery"
                        ],
                        "position": {
                                "x": 500,
                                "y": 50
                        },
                        "sensors": {
                                "thermal_monitoring": [
                                        {
                                                "id": "TEMP-001",
                                                "type": "Horno Principal",
                                                "value": 939.625623107482,
                                                "unit": "\u00b0C",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "TEMP-002",
                                                "type": "C\u00e1mara de Enfriamiento",
                                                "value": 210.9130586395157,
                                                "unit": "\u00b0C",
                                                "status": "WARNING"
                                        },
                                        {
                                                "id": "TEMP-003",
                                                "type": "Detector de Fugas T\u00e9rmica",
                                                "value": 2.958163583604627,
                                                "unit": "kW perdidos",
                                                "status": "WARNING"
                                        }
                                ],
                                "gas_monitoring": [
                                        {
                                                "id": "GAS-001",
                                                "type": "Detector CO",
                                                "value": 9.047074846478871,
                                                "unit": "ppm",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "GAS-002",
                                                "type": "Detector NH3",
                                                "value": 2.4255868756818475,
                                                "unit": "ppm",
                                                "status": "CRITICAL"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-130-THERMAL",
                                "subnet": "192.168.130.0/24",
                                "devices": 32,
                                "bandwidth_usage": 84.94169306148859,
                                "security_level": "CRITICAL"
                        },
                        "metrics_data": {
                                "furnace_temperature": [
                                        868.8226092711707,
                                        906.37187806024,
                                        875.5653638323836,
                                        955.176449063433,
                                        946.7686659379028,
                                        914.2609767248441,
                                        855.6173693708944,
                                        847.9681162252265,
                                        898.065378101008,
                                        882.2772133915399,
                                        932.21708167745,
                                        955.1780938755653,
                                        862.7346493887993,
                                        948.4082949823104,
                                        928.186414148548,
                                        910.5188270085347,
                                        882.9726563188023,
                                        934.6823545207528,
                                        872.1076699801017,
                                        937.1411724489468,
                                        917.4223309368062,
                                        921.2750547246683,
                                        856.484273758313,
                                        866.4015604340917
                                ],
                                "energy_consumption": [
                                        3091.5937069624974,
                                        2932.36100415852,
                                        3012.567820562561,
                                        3009.2889358299976,
                                        3112.1880480454674,
                                        2847.880487439356,
                                        3053.6841822029664,
                                        2828.7712583237544,
                                        2922.454907536255,
                                        2905.095946720919,
                                        3066.8670174335803,
                                        3175.669655858534,
                                        3165.125945686943,
                                        2975.9817421406265,
                                        2964.6017970351645,
                                        2936.866291726004,
                                        2914.308520281438,
                                        2988.666521869433,
                                        3110.5923300392274,
                                        2964.0854664781655,
                                        3039.165286537921,
                                        3133.0324763956587,
                                        2915.1848596900063,
                                        2834.349505806719
                                ],
                                "thermal_efficiency": [
                                        81.4943320063521,
                                        82.92708595475699,
                                        78.53821931817484,
                                        86.71450147148462,
                                        86.76998505085935,
                                        81.20651876021931,
                                        82.26626878955264,
                                        81.93559131797252,
                                        79.66068797630973,
                                        78.11218687477144,
                                        79.93139252583013,
                                        86.05979742139641,
                                        86.73485687127064,
                                        83.80846237296106,
                                        83.45290065149777,
                                        87.17961474323104,
                                        82.14081833382193,
                                        85.88344978783529,
                                        85.31374137507983,
                                        78.47894242419777,
                                        81.68207971792789,
                                        83.47346480083263,
                                        86.71632491966108,
                                        79.99323153931786
                                ]
                        }
                },
                "power_distribution": {
                        "id": "power_distribution",
                        "name": "Distribuci\u00f3n El\u00e9ctrica",
                        "type": "utility",
                        "icon": "fas fa-bolt",
                        "status": "operational",
                        "alerts": 1,
                        "personnel": 3,
                        "throughput": 97.1969204157071,
                        "connections": [
                                "ups_systems"
                        ],
                        "position": {
                                "x": 800,
                                "y": 250
                        },
                        "sensors": {
                                "electrical_monitoring": [
                                        {
                                                "id": "POW-001",
                                                "type": "L\u00ednea Principal A",
                                                "load": 79.8113359323482,
                                                "unit": "%",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "POW-002",
                                                "type": "L\u00ednea Principal B",
                                                "load": 71.61176755005955,
                                                "unit": "%",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "POW-003",
                                                "type": "L\u00ednea de Emergencia",
                                                "load": 11.103546429772189,
                                                "unit": "%",
                                                "status": "STANDBY"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-200-POWER",
                                "subnet": "192.168.200.0/24",
                                "devices": 28,
                                "bandwidth_usage": 48.14323973175826,
                                "security_level": "CRITICAL"
                        },
                        "metrics_data": {
                                "power_consumption": [
                                        2670.008538555363,
                                        2833.9833634075953,
                                        3356.5568613263,
                                        3359.481059440827,
                                        3013.290844317541,
                                        2947.180163967387,
                                        2608.294442224001,
                                        2710.8062210804937,
                                        2765.108762971303,
                                        2766.8489904735306,
                                        2620.8166464939145,
                                        3258.2860342964987,
                                        2934.1592010037466,
                                        3245.8467475856232,
                                        2732.2609951098475,
                                        3324.1246624838013,
                                        3038.026914003003,
                                        2876.4470770844873,
                                        2781.631025940732,
                                        3398.891250166195,
                                        2600.722279764791,
                                        2707.19565313948,
                                        2796.2670480334555,
                                        2743.212388637911
                                ],
                                "power_factor": [
                                        0.9024513235022636,
                                        0.8997322824826166,
                                        0.8850686519108468,
                                        0.9495705463580242,
                                        0.941477723743334,
                                        0.8943783100865225,
                                        0.9424703946401762,
                                        0.9077790548851639,
                                        0.9060948788372172,
                                        0.9209933735085147,
                                        0.8889568403247071,
                                        0.9584723597419129,
                                        0.920958565775031,
                                        0.9566457369176772,
                                        0.9545582292943963,
                                        0.8835731359974004,
                                        0.932612045599488,
                                        0.9283869834338488,
                                        0.945495996558729,
                                        0.8894321208599246,
                                        0.9084440934893568,
                                        0.9558446756590183,
                                        0.9311921844999207,
                                        0.9470153682054865
                                ],
                                "harmonic_distortion": [
                                        4.85751021135563,
                                        5.763924697083475,
                                        3.317157149744602,
                                        5.708081170181183,
                                        5.285655150075913,
                                        4.522841285895107,
                                        4.094759628364871,
                                        5.083630470044815,
                                        3.3751388624529772,
                                        3.6342021071090107,
                                        5.5672452767345835,
                                        4.835322345997806,
                                        2.2488969686211577,
                                        2.4783578042980787,
                                        2.3595155107347505,
                                        4.596417086230513,
                                        4.032003435658524,
                                        2.992047375091026,
                                        6.152928716934628,
                                        6.762837066811608,
                                        3.8667252951106663,
                                        5.411959774197491,
                                        5.91678973167556,
                                        4.34426585995492
                                ]
                        }
                },
                "packaging": {
                        "id": "packaging",
                        "name": "Empaquetado",
                        "type": "process",
                        "icon": "fas fa-box",
                        "status": "operational",
                        "alerts": 3,
                        "personnel": 9,
                        "throughput": 92.68018440140985,
                        "connections": [
                                "warehouse"
                        ],
                        "position": {
                                "x": 1100,
                                "y": 100
                        },
                        "sensors": {
                                "production_flow": [
                                        {
                                                "id": "FLOW-001",
                                                "type": "Contador de Productos",
                                                "value": 1873,
                                                "unit": "unid/h",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "FLOW-002",
                                                "type": "Sensor de Atascos",
                                                "events": 0,
                                                "unit": "eventos/h",
                                                "status": "NORMAL"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-150-PACK",
                                "subnet": "192.168.150.0/24",
                                "devices": 38,
                                "bandwidth_usage": 69.96661417550322,
                                "security_level": "HIGH"
                        },
                        "metrics_data": {
                                "packaging_speed": [
                                        1863.0704186972055,
                                        2098.1120255850315,
                                        2208.9245392590788,
                                        2268.8091596686204,
                                        1860.3902725741475,
                                        2151.2039544800164,
                                        2083.435930088769,
                                        2048.477204088286,
                                        2081.853170009197,
                                        2003.7836963652849,
                                        1814.6191313745633,
                                        2282.0294182713938,
                                        2114.581845768928,
                                        2028.512512201486,
                                        1914.1208985831624,
                                        1991.4372983017115,
                                        2299.251572053501,
                                        2006.6666083047287,
                                        2018.2270248603845,
                                        1829.2064274540946,
                                        2217.8023386402233,
                                        1939.452035242082,
                                        1823.0661999163017,
                                        1949.3772048083167
                                ],
                                "defect_rate": [
                                        1.6235787674137063,
                                        1.752611083966676,
                                        2.2400716382245394,
                                        2.326679536204458,
                                        0.9723978786396893,
                                        1.0871044545258908,
                                        1.480026273615588,
                                        0.6425161261973612,
                                        1.8772226964883643,
                                        0.5313298630389276,
                                        1.4581918758145898,
                                        0.5364959776004532,
                                        2.514772823807989,
                                        0.8656363400068324,
                                        1.0518801218329856,
                                        2.7909627588797488,
                                        1.571798266102315,
                                        1.5461934861410531,
                                        0.7354171715151849,
                                        0.667170755365659,
                                        1.1029486654218894,
                                        2.477125285902686,
                                        1.3212856388980292,
                                        2.719926073593111
                                ],
                                "efficiency": [
                                        93.1127826773473,
                                        95.82802474074029,
                                        82.26490851495596,
                                        87.73812433840965,
                                        94.70500652822093,
                                        89.29601394138903,
                                        83.14810960639232,
                                        90.43099918551842,
                                        83.69749099329228,
                                        90.08688718901391,
                                        91.234436710935,
                                        92.73843430146725,
                                        83.55638989768313,
                                        88.07648024993466,
                                        84.1506383993645,
                                        94.8145382066547,
                                        82.28477214583583,
                                        91.03792748188967,
                                        82.47334428427992,
                                        86.46269638220129,
                                        88.95871086418171,
                                        86.886963983138,
                                        88.60195332059953,
                                        90.90951236053657
                                ]
                        }
                }
        }
};
        let selectedProcess = null;
        let performanceChart = null;
        let realtimeChart = null;

        // Configuración global de gráficos
        Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
        Chart.defaults.color = '#ffffff';

        // Función principal para seleccionar proceso
        function selectProcess(processId) {
            // Limpiar selección anterior
            document.querySelectorAll('.process-node').forEach(node => {
                node.classList.remove('selected');
            });

            // Seleccionar nuevo proceso
            selectedProcess = processId;
            const node = document.getElementById('node_' + processId);
            node.classList.add('selected');

            const processData = systemData.process_flow[processId];

            // Actualizar badge
            document.getElementById('selectedProcessBadge').textContent = processData.name;

            // Mostrar secciones de análisis
            showAnalyticsSection(processData);
            showMLESection(processData);
        }

        // Mostrar sección de analytics
        function showAnalyticsSection(processData) {
            document.getElementById('analyticsTitle').innerHTML = `
                <i class="fas fa-chart-line me-2"></i>
                Análisis Detallado: ${processData.name}
            `;

            // Generar KPIs del proceso
            generateProcessKPIs(processData);

            // Generar detalles técnicos
            generateTechnicalDetails(processData);

            // Crear gráficos
            createPerformanceChart(processData);
            createRealtimeChart(processData);

            // Mostrar sección
            document.getElementById('analyticsSection').style.display = 'block';
        }

        // Generar KPIs del proceso
        function generateProcessKPIs(processData) {
            const kpisHtml = `
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-tachometer-alt text-info"></i>
                        </div>
                        <h5 class="text-white">Rendimiento</h5>
                        <h3 class="text-info">${processData.throughput.toFixed(1)}%</h3>
                        <small class="text-light">Eficiencia actual</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-exclamation-triangle text-warning"></i>
                        </div>
                        <h5 class="text-white">Alertas</h5>
                        <h3 class="text-warning">${processData.alerts}</h3>
                        <small class="text-light">Alertas activas</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-users text-success"></i>
                        </div>
                        <h5 class="text-white">Personal</h5>
                        <h3 class="text-success">${processData.personnel}</h3>
                        <small class="text-light">Operadores</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-network-wired text-purple"></i>
                        </div>
                        <h5 class="text-white">Red</h5>
                        <h3 class="text-purple">${processData.network.devices}</h3>
                        <small class="text-light">Dispositivos</small>
                    </div>
                </div>
            `;
            document.getElementById('processKPIs').innerHTML = kpisHtml;
        }

        // Generar detalles técnicos
        function generateTechnicalDetails(processData) {
            let sensorsHtml = '';
            if (processData.sensors) {
                Object.keys(processData.sensors).forEach(category => {
                    const sensors = processData.sensors[category];
                    const categoryTitle = category.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());

                    sensorsHtml += `
                        <div class="col-md-6 mb-3">
                            <div class="glass-card p-3">
                                <h6 class="text-warning mb-2">${categoryTitle}</h6>`;

                    sensors.forEach(sensor => {
                        const statusClass = sensor.status === 'NORMAL' || sensor.status === 'OPERATIONAL' ? 'success' : 'warning';
                        sensorsHtml += `
                            <div class="d-flex justify-content-between align-items-center mb-2 p-2 bg-dark rounded">
                                <div>
                                    <strong class="text-white">${sensor.id || sensor.type || sensor.parameter}</strong><br>
                                    <small class="text-light">${sensor.type || sensor.parameter || 'Sensor'}</small>
                                </div>
                                <div class="text-end">
                                    <span class="text-white">${sensor.value || sensor.samples_hour || sensor.accuracy || 'N/A'} ${sensor.unit || ''}</span><br>
                                    <span class="badge bg-${statusClass}">${sensor.status}</span>
                                </div>
                            </div>`;
                    });

                    sensorsHtml += '</div></div>';
                });
            }

            // Información de red
            const networkHtml = `
                <div class="col-md-6 mb-3">
                    <div class="glass-card p-3">
                        <h6 class="text-info mb-2">Información de Red</h6>
                        <div class="row">
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">VLAN</strong><br>
                                    <span class="text-white">${processData.network.vlan}</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">Dispositivos</strong><br>
                                    <span class="text-white">${processData.network.devices}</span>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">Subred</strong><br>
                                    <span class="text-white">${processData.network.subnet}</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">Uso BW</strong><br>
                                    <span class="text-white">${processData.network.bandwidth_usage.toFixed(1)}%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('technicalDetails').innerHTML = sensorsHtml + networkHtml;
        }

        // Crear gráfico de rendimiento
        function createPerformanceChart(processData) {
            if (performanceChart) {
                performanceChart.destroy();
            }

            const ctx = document.getElementById('performanceChart').getContext('2d');
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);

            let data1, data2, data3;
            if (processData.metrics_data) {
                const metrics = Object.values(processData.metrics_data);
                data1 = metrics[0] || Array.from({length: 24}, () => Math.random() * 20 + 80);
                data2 = metrics[1] || Array.from({length: 24}, () => Math.random() * 20 + 80);
                data3 = metrics[2] || Array.from({length: 24}, () => Math.random() * 20 + 80);
            } else {
                data1 = Array.from({length: 24}, () => Math.random() * 20 + 80);
                data2 = Array.from({length: 24}, () => Math.random() * 20 + 80);
                data3 = Array.from({length: 24}, () => Math.random() * 20 + 80);
            }

            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hours,
                    datasets: [{
                        label: 'Métrica 1',
                        data: data1,
                        borderColor: '#4ECDC4',
                        backgroundColor: 'rgba(78, 205, 196, 0.2)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Métrica 2',
                        data: data2,
                        borderColor: '#FF6B6B',
                        backgroundColor: 'rgba(255, 107, 107, 0.2)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Métrica 3',
                        data: data3,
                        borderColor: '#FFA726',
                        backgroundColor: 'rgba(255, 167, 38, 0.2)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Crear gráfico en tiempo real
        function createRealtimeChart(processData) {
            if (realtimeChart) {
                realtimeChart.destroy();
            }

            const ctx = document.getElementById('realtimeChart').getContext('2d');

            realtimeChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Rendimiento', 'Disponible'],
                    datasets: [{
                        data: [processData.throughput, 100 - processData.throughput],
                        backgroundColor: [
                            '#4ECDC4',
                            'rgba(255, 255, 255, 0.1)'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    }
                }
            });
        }

        // Mostrar sección MLE
        function showMLESection(processData) {
            document.getElementById('mleSection').style.display = 'block';

            // Placeholder para recomendaciones
            document.getElementById('mleRecommendations').innerHTML = `
                <div class="text-center text-light p-4">
                    <i class="fas fa-robot fa-3x mb-3 text-info"></i>
                    <h6>MLE Star listo para analizar: ${processData.name}</h6>
                    <p>Haga click en "Ejecutar Análisis" para obtener recomendaciones específicas</p>
                </div>
            `;
        }

        // Ejecutar análisis MLE
        function runMLEAnalysis() {
            if (!selectedProcess) return;

            const processData = systemData.process_flow[selectedProcess];

            // Simular análisis (en producción vendría del backend)
            const recommendations = generateMLERecommendations(processData);

            let html = '';
            recommendations.forEach((rec, index) => {
                html += `
                    <div class="mle-recommendation severity-${rec.severity.toLowerCase()}">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h6 class="text-white">${rec.title}</h6>
                            <span class="badge bg-${rec.severity.toLowerCase()}">${rec.severity}</span>
                        </div>
                        <p class="text-light mb-3">${rec.description}</p>

                        <h6 class="text-warning mb-2">Acciones Recomendadas:</h6>
                        <ul class="text-light">`;

                rec.actions.forEach(action => {
                    html += `<li>${action}</li>`;
                });

                html += `</ul>

                        <div class="row mt-3">
                            <div class="col-md-6">
                                <h6 class="text-info mb-2">Detalles Técnicos:</h6>`;

                Object.keys(rec.technical_details).forEach(key => {
                    html += `<small class="text-light d-block">${key.replace('_', ' ')}: <strong>${rec.technical_details[key]}</strong></small>`;
                });

                html += `
                            </div>
                            <div class="col-md-6 text-end">
                                <button class="btn btn-success btn-sm me-2" onclick="implementRecommendation(${index})">
                                    <i class="fas fa-play me-1"></i>Implementar
                                </button>
                                <button class="btn btn-info btn-sm" onclick="scheduleRecommendation(${index})">
                                    <i class="fas fa-calendar me-1"></i>Programar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('mleRecommendations').innerHTML = html;
        }

        // Generar recomendaciones MLE (simplificado)
        function generateMLERecommendations(processData) {
            const recommendations = [];

            if (processData.throughput < 90) {
                recommendations.push({
                    title: 'Optimización de Rendimiento',
                    description: `Rendimiento actual de ${processData.throughput.toFixed(1)}% está por debajo del objetivo`,
                    severity: processData.throughput < 80 ? 'HIGH' : 'MEDIUM',
                    actions: [
                        'Analizar cuellos de botella en el proceso',
                        'Implementar control predictivo avanzado',
                        'Optimizar parámetros de operación'
                    ],
                    technical_details: {
                        'rendimiento_actual': processData.throughput.toFixed(1) + '%',
                        'objetivo': '95%+',
                        'mejora_potencial': (95 - processData.throughput).toFixed(1) + '%'
                    }
                });
            }

            if (processData.alerts > 2) {
                recommendations.push({
                    title: 'Reducción de Alertas',
                    description: `${processData.alerts} alertas activas requieren atención`,
                    severity: 'HIGH',
                    actions: [
                        'Investigar causas raíz de alertas recurrentes',
                        'Ajustar umbrales de alarma',
                        'Implementar mantenimiento preventivo'
                    ],
                    technical_details: {
                        'alertas_actuales': processData.alerts,
                        'objetivo': '< 2',
                        'reduccion_requerida': Math.max(0, processData.alerts - 2)
                    }
                });
            }

            if (processData.network.bandwidth_usage > 70) {
                recommendations.push({
                    title: 'Optimización de Red',
                    description: `Uso de ancho de banda del ${processData.network.bandwidth_usage.toFixed(1)}% es elevado`,
                    severity: 'MEDIUM',
                    actions: [
                        'Implementar Quality of Service (QoS)',
                        'Optimizar protocolos de comunicación',
                        'Revisar tráfico no esencial'
                    ],
                    technical_details: {
                        'uso_actual': processData.network.bandwidth_usage.toFixed(1) + '%',
                        'objetivo': '< 70%',
                        'dispositivos': processData.network.devices
                    }
                });
            }

            return recommendations;
        }

        // Funciones de acción
        function implementRecommendation(index) {
            alert(`✅ Implementando recomendación #${index + 1}\n\nSe creará ticket de trabajo automáticamente.`);
        }

        function scheduleRecommendation(index) {
            const date = prompt('Ingrese fecha para programar (YYYY-MM-DD):');
            if (date) {
                alert(`📅 Recomendación #${index + 1} programada para ${date}`);
            }
        }

        console.log('🚀 SmartCompute Dashboard Híbrido iniciado');
        console.log('📊 Procesos disponibles:', Object.keys(systemData.process_flow).length);
    </script>
</body>
</html>