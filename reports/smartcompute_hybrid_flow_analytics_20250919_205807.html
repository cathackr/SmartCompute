
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartCompute Industrial - Dashboard Híbrido Avanzado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 50%, #2980b9 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        .process-flow-map {
            position: relative;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
            border-radius: 15px;
            height: 500px;
            overflow: auto;
            padding: 20px;
        }
        .process-node {
            position: absolute;
            width: 120px;
            height: 80px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 8px;
            font-size: 0.7rem;
            font-weight: bold;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        .process-node:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            z-index: 10;
        }
        .process-node.selected {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.3);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        .process-node.input {
            background: rgba(76, 175, 80, 0.3);
            border-color: #4CAF50;
        }
        .process-node.process {
            background: rgba(33, 150, 243, 0.3);
            border-color: #2196F3;
        }
        .process-node.utility {
            background: rgba(156, 39, 176, 0.3);
            border-color: #9C27B0;
        }
        .connection-line {
            position: absolute;
            height: 4px;
            background: linear-gradient(90deg, rgba(52,152,219,0.4), rgba(52,152,219,0.9), rgba(52,152,219,0.4));
            border-radius: 2px;
            transform-origin: left center;
            animation: flow 3s infinite;
            z-index: 1;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .connection-arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 10px solid rgba(52,152,219,0.9);
            border-top: 7px solid transparent;
            border-bottom: 7px solid transparent;
            z-index: 2;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.2));
        }
        .chart-container {
            position: relative;
            height: 350px;
            margin: 15px 0;
        }
        .metric-card {
            transition: transform 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-5px);
        }
        .mle-recommendation {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #FFC107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .severity-high { border-left-color: #dc3545; }
        .severity-medium { border-left-color: #ffc107; }
        .severity-low { border-left-color: #28a745; }
        @keyframes flow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="glass-card p-4 text-center">
                    <h1 class="text-white display-4 mb-3">
                        <i class="fas fa-industry me-3"></i>
                        SmartCompute Industrial - Dashboard Híbrido
                    </h1>
                    <h2 class="text-white mb-3">
                        Diagrama de Flujo + Analytics + MLE Star
                    </h2>
                    <div class="row text-white">
                        <div class="col-md-4">
                            <i class="fas fa-clock me-2"></i>
                            <strong>Actualizado:</strong> 2025-09-19 20:58:07
                        </div>
                        <div class="col-md-4">
                            <i class="fas fa-mouse-pointer me-2"></i>
                            <strong>Click en proceso</strong> para análisis detallado
                        </div>
                        <div class="col-md-4">
                            <i class="fas fa-robot me-2"></i>
                            <strong>MLE Star</strong> analiza cada área
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Process Flow Map -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="glass-card p-4">
                    <h5 class="text-white mb-3">
                        <i class="fas fa-project-diagram me-2"></i>
                        Diagrama de Flujo de Procesos Industriales
                        <span class="badge bg-info ms-2" id="selectedProcessBadge">Seleccione un proceso</span>
                    </h5>
                    <div class="process-flow-map" id="processFlowMap">
                        <div class="process-node input operational"
                             style="left: 50px; top: 100px;"
                             onclick="selectProcess('raw_materials')"
                             data-node-id="raw_materials"
                             id="node_raw_materials">
                            <div class="node-icon">
                                <i class="fas fa-boxes"></i>
                            </div>
                            <div class="node-name">Materias Primas</div>
                            <div class="node-status">0 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 97%"></div>
                            </div>
                        </div>
                        <div class="process-node process warning"
                             style="left: 200px; top: 100px;"
                             onclick="selectProcess('quality_control_in')"
                             data-node-id="quality_control_in"
                             id="node_quality_control_in">
                            <div class="node-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="node-name">Control de Calidad Entrada</div>
                            <div class="node-status">1 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 91%"></div>
                            </div>
                        </div>
                        <div class="process-node process critical"
                             style="left: 350px; top: 100px;"
                             onclick="selectProcess('preparation')"
                             data-node-id="preparation"
                             id="node_preparation">
                            <div class="node-icon">
                                <i class="fas fa-blender"></i>
                            </div>
                            <div class="node-name">Preparación y Mezclado</div>
                            <div class="node-status">3 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 93%"></div>
                            </div>
                        </div>
                        <div class="process-node process critical"
                             style="left: 500px; top: 50px;"
                             onclick="selectProcess('thermal_treatment')"
                             data-node-id="thermal_treatment"
                             id="node_thermal_treatment">
                            <div class="node-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="node-name">Tratamiento Térmico</div>
                            <div class="node-status">4 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 78%"></div>
                            </div>
                        </div>
                        <div class="process-node utility warning"
                             style="left: 800px; top: 250px;"
                             onclick="selectProcess('power_distribution')"
                             data-node-id="power_distribution"
                             id="node_power_distribution">
                            <div class="node-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="node-name">Distribución Eléctrica</div>
                            <div class="node-status">2 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 94%"></div>
                            </div>
                        </div>
                        <div class="process-node process critical"
                             style="left: 1100px; top: 100px;"
                             onclick="selectProcess('packaging')"
                             data-node-id="packaging"
                             id="node_packaging">
                            <div class="node-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            <div class="node-name">Empaquetado</div>
                            <div class="node-status">3 alertas</div>
                            <div class="throughput-bar">
                                <div class="throughput-fill" style="width: 93%"></div>
                            </div>
                        </div>
                        <div class="connection-line"
                             style="left: 170px;
                                    top: 138.5px;
                                    width: 18.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-arrow"
                             style="left: 182.0px;
                                    top: 134.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-line"
                             style="left: 320px;
                                    top: 138.5px;
                                    width: 18.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-arrow"
                             style="left: 332.0px;
                                    top: 134.0px;
                                    transform: rotate(0.0deg);">
                        </div>
                        <div class="connection-line"
                             style="left: 470px;
                                    top: 138.5px;
                                    width: 46.309518948453004px;
                                    transform: rotate(-59.03624346792648deg);">
                        </div>
                        <div class="connection-arrow"
                             style="left: 487.82605093486967px;
                                    top: 94.28991510855053px;
                                    transform: rotate(-59.03624346792648deg);">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Section (Initially Hidden) -->
        <div class="row mb-4" id="analyticsSection" style="display: none;">
            <div class="col-12">
                <div class="glass-card p-4">
                    <h5 class="text-white mb-3" id="analyticsTitle">
                        <i class="fas fa-chart-line me-2"></i>
                        Análisis Detallado del Proceso
                    </h5>

                    <!-- Process KPIs -->
                    <div class="row mb-4" id="processKPIs">
                        <!-- Will be populated by JavaScript -->
                    </div>

                    <!-- Charts Row -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="glass-card p-4">
                                <h6 class="text-white mb-3">
                                    <i class="fas fa-chart-area me-2"></i>
                                    Tendencias de Rendimiento (24h)
                                </h6>
                                <div class="chart-container">
                                    <canvas id="performanceChart"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="glass-card p-4">
                                <h6 class="text-white mb-3">
                                    <i class="fas fa-tachometer-alt me-2"></i>
                                    Métricas en Tiempo Real
                                </h6>
                                <div class="chart-container">
                                    <canvas id="realtimeChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Network and Sensors Details -->
                    <div class="row mb-4" id="technicalDetails">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- MLE Star Analysis Section -->
        <div class="row mb-4" id="mleSection" style="display: none;">
            <div class="col-12">
                <div class="glass-card p-4">
                    <h5 class="text-white mb-3">
                        <i class="fas fa-robot me-2"></i>
                        Análisis MLE Star - Recomendaciones Específicas
                        <button class="btn btn-sm btn-outline-success ms-2" onclick="runMLEAnalysis()">
                            <i class="fas fa-play"></i> Ejecutar Análisis
                        </button>
                    </h5>
                    <div id="mleRecommendations">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="row">
            <div class="col-12">
                <div class="glass-card p-3 text-center">
                    <small class="text-white">
                        SmartCompute Industrial - Dashboard Híbrido |
                        <a href="mailto:ggwre04p0@mozmail.com" class="text-info">ggwre04p0@mozmail.com</a> |
                        <a href="https://www.linkedin.com/in/martín-iribarne-swtf/" class="text-info" target="_blank">LinkedIn</a>
                    </small>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos del sistema
        const systemData = {
        "timestamp": "2025-09-19 20:58:07.118015",
        "system_health": {
                "overall_score": 96.27254561983679,
                "cpu_usage": 10.320929446597813,
                "memory_usage": 60.51652566145471,
                "temperature": 54.01861225687526,
                "uptime_hours": 7909
        },
        "process_flow": {
                "raw_materials": {
                        "id": "raw_materials",
                        "name": "Materias Primas",
                        "type": "input",
                        "icon": "fas fa-boxes",
                        "status": "operational",
                        "alerts": 0,
                        "personnel": 5,
                        "throughput": 96.94851392205484,
                        "connections": [
                                "quality_control_in"
                        ],
                        "position": {
                                "x": 50,
                                "y": 100
                        },
                        "sensors": {
                                "weight_scales": [
                                        {
                                                "id": "WS-001",
                                                "type": "B\u00e1scula Industrial",
                                                "value": 12.943280598979022,
                                                "unit": "Ton",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "WS-002",
                                                "type": "B\u00e1scula de Precisi\u00f3n",
                                                "value": 1195.3445119611692,
                                                "unit": "kg",
                                                "status": "NORMAL"
                                        }
                                ],
                                "inventory": [
                                        {
                                                "id": "INV-001",
                                                "material": "Acero Inoxidable 316L",
                                                "quantity": 89.45476927169615,
                                                "unit": "%",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "INV-002",
                                                "material": "Pol\u00edmero PET",
                                                "quantity": 62.49671342215256,
                                                "unit": "%",
                                                "status": "WARNING"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-100-RAW",
                                "subnet": "192.168.100.0/24",
                                "devices": 12,
                                "bandwidth_usage": 28.322177385770242,
                                "security_level": "HIGH"
                        },
                        "metrics_data": {
                                "throughput_history": [
                                        94.36070397793944,
                                        82.21228572630237,
                                        84.35589591008535,
                                        82.88681271142305,
                                        83.8269696571578,
                                        84.46435055330687,
                                        90.49327374863529,
                                        90.58284367544786,
                                        82.31089674181646,
                                        88.49555086190398,
                                        87.17850466130714,
                                        80.50503593719412,
                                        93.01575849370778,
                                        85.73265545111532,
                                        93.1625246481235,
                                        92.65977235419517,
                                        88.8125148456482,
                                        84.51037187463895,
                                        86.76849591522641,
                                        85.05101129053605,
                                        86.14249635198475,
                                        82.86158052399983,
                                        82.97819260040902,
                                        84.39379896460468
                                ],
                                "inventory_levels": [
                                        70.69590658380635,
                                        88.63481411204086,
                                        75.03443216744081,
                                        74.08282896361312,
                                        88.07930995464783,
                                        85.28834693031925,
                                        77.36583533264537,
                                        89.3323355181438,
                                        85.6889561768465,
                                        76.02608281265844,
                                        81.73129522732755,
                                        94.88382200035605,
                                        88.23075769634097,
                                        81.03592631804904,
                                        90.20370021434248,
                                        91.63460708463232,
                                        71.30552196260626,
                                        74.82343137795216,
                                        77.09218752651742,
                                        74.1777218388159,
                                        87.39908066697527,
                                        91.48122572283617,
                                        78.39711133931961,
                                        74.97287846186292
                                ],
                                "quality_scores": [
                                        92.97907751806393,
                                        92.41141392128208,
                                        97.84251533028574,
                                        92.87284603449208,
                                        95.76495360681335,
                                        97.98284150772317,
                                        97.29600411652025,
                                        92.26408148527261,
                                        93.4326911868109,
                                        97.52980191011768,
                                        97.15584294948134,
                                        92.8846250511711,
                                        95.5362353584401,
                                        92.95245251586265,
                                        93.5934696353999,
                                        95.02884878266977,
                                        92.34393869056746,
                                        95.72540091180078,
                                        93.51505822309919,
                                        97.61276612273119,
                                        96.1812572170344,
                                        97.0858535598517,
                                        96.08289325534523,
                                        93.5174821158107
                                ]
                        }
                },
                "quality_control_in": {
                        "id": "quality_control_in",
                        "name": "Control de Calidad Entrada",
                        "type": "process",
                        "icon": "fas fa-search",
                        "status": "operational",
                        "alerts": 1,
                        "personnel": 4,
                        "throughput": 91.24943808369956,
                        "connections": [
                                "preparation"
                        ],
                        "position": {
                                "x": 200,
                                "y": 100
                        },
                        "sensors": {
                                "sampling": [
                                        {
                                                "id": "SAMP-001",
                                                "type": "Muestreador Autom\u00e1tico",
                                                "samples_hour": 16,
                                                "status": "OPERATIONAL"
                                        },
                                        {
                                                "id": "SAMP-002",
                                                "type": "Analizador Espectral",
                                                "accuracy": 99.82433352636019,
                                                "unit": "%",
                                                "status": "OPERATIONAL"
                                        }
                                ],
                                "compliance": [
                                        {
                                                "standard": "ISO 9001:2015",
                                                "compliance": 99.15345802640825,
                                                "last_audit": "2025-09-15"
                                        },
                                        {
                                                "standard": "FDA 21 CFR 11",
                                                "compliance": 97.43767265570732,
                                                "incidents": 2
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-110-QC",
                                "subnet": "192.168.110.0/24",
                                "devices": 18,
                                "bandwidth_usage": 45.72630793011327,
                                "security_level": "CRITICAL"
                        },
                        "metrics_data": {
                                "sample_processing": [
                                        23,
                                        22,
                                        28,
                                        24,
                                        20,
                                        26,
                                        23,
                                        20,
                                        21,
                                        28,
                                        23,
                                        21,
                                        22,
                                        21,
                                        26,
                                        22,
                                        22,
                                        27,
                                        24,
                                        19,
                                        19,
                                        26,
                                        21,
                                        26
                                ],
                                "compliance_scores": [
                                        94.33094016887767,
                                        94.01353719245671,
                                        94.19275371822972,
                                        94.47312009468173,
                                        96.53374061603239,
                                        99.42729917499577,
                                        98.06222855688941,
                                        97.2296864656977,
                                        95.22725864278173,
                                        98.65502875159949,
                                        97.96392539101386,
                                        97.66560600999598,
                                        98.54013213271836,
                                        98.70208604871225,
                                        97.62493923767708,
                                        94.29794432200406,
                                        95.58614531822604,
                                        96.4352955399771,
                                        96.51407749712416,
                                        98.10228360428272,
                                        95.8782996688017,
                                        96.08864818397893,
                                        98.58404426278675,
                                        94.73837770219072
                                ],
                                "rejection_rates": [
                                        1.095422995615149,
                                        1.1642001252544056,
                                        2.09366979052454,
                                        1.26626475226013,
                                        0.9625035604296854,
                                        0.9283068107360561,
                                        2.1401100152797703,
                                        0.5168869136615664,
                                        0.9429907262326677,
                                        0.798469005610039,
                                        0.8557080016835539,
                                        0.5358048134515584,
                                        2.2411302577381447,
                                        1.8663932190682524,
                                        0.8123060164902942,
                                        0.19363391725552426,
                                        1.286850273163347,
                                        0.6351961635981134,
                                        0.5495634207449418,
                                        0.781802051704029,
                                        0.9817341350974015,
                                        1.5278141216449728,
                                        2.179751893925299,
                                        1.621369236137353
                                ]
                        }
                },
                "preparation": {
                        "id": "preparation",
                        "name": "Preparaci\u00f3n y Mezclado",
                        "type": "process",
                        "icon": "fas fa-blender",
                        "status": "operational",
                        "alerts": 3,
                        "personnel": 8,
                        "throughput": 92.67392873796464,
                        "connections": [
                                "thermal_treatment",
                                "quality_control_process"
                        ],
                        "position": {
                                "x": 350,
                                "y": 100
                        },
                        "sensors": {
                                "mixing_parameters": [
                                        {
                                                "id": "MIX-001",
                                                "parameter": "Velocidad de Mezclado",
                                                "value": 191.51946748240928,
                                                "unit": "RPM",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "MIX-002",
                                                "parameter": "Presi\u00f3n de Mezclado",
                                                "value": 3.024021099640957,
                                                "unit": "bar",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "MIX-003",
                                                "parameter": "Temperatura de Mezcla",
                                                "value": 74.6726134408987,
                                                "unit": "\u00b0C",
                                                "status": "WARNING"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-120-PREP",
                                "subnet": "192.168.120.0/24",
                                "devices": 25,
                                "bandwidth_usage": 59.50323384390451,
                                "security_level": "HIGH"
                        },
                        "metrics_data": {
                                "mixing_efficiency": [
                                        85.98987589103889,
                                        85.35076918390678,
                                        94.68775915825076,
                                        94.26163002335127,
                                        91.49789269383552,
                                        90.9350275092239,
                                        92.39039965799356,
                                        85.82978516720593,
                                        87.15050654355655,
                                        88.0167930838704,
                                        92.08272118583139,
                                        90.02340773149736,
                                        92.31934320577083,
                                        92.43666782652443,
                                        91.78628205085535,
                                        92.82446478540525,
                                        93.6891580170807,
                                        93.38491392287278,
                                        88.05558851467589,
                                        87.56371831417825,
                                        86.28348762668465,
                                        88.51664710394098,
                                        87.58917928837919,
                                        89.63014207174461
                                ],
                                "temperature_profile": [
                                        76.92471495316107,
                                        72.44359268272073,
                                        77.67964121588213,
                                        69.66129291084476,
                                        71.72718752717633,
                                        71.71028458070606,
                                        75.70452008502184,
                                        76.14173915009714,
                                        69.63498225581257,
                                        74.98360613965369,
                                        72.98897788216509,
                                        74.90643895730236,
                                        75.14227615159955,
                                        71.17767168732107,
                                        71.41429795970802,
                                        71.22993392901006,
                                        69.51886828106767,
                                        72.56633626987646,
                                        72.79455086530072,
                                        70.20604813009352,
                                        76.03878805617569,
                                        71.51788612153368,
                                        71.58615119101329,
                                        75.32741032854398
                                ],
                                "pressure_stability": [
                                        3.035241803639732,
                                        3.0690400607369535,
                                        3.463598671908937,
                                        3.690516647179181,
                                        2.6198694733540955,
                                        2.7224113685603593,
                                        3.1046270789643,
                                        3.5573228401497907,
                                        3.371738487698081,
                                        3.6828413304965006,
                                        3.1587274566215835,
                                        3.405918629591028,
                                        2.7236424104232966,
                                        2.6505991760944476,
                                        2.5169209195374136,
                                        2.8013817435090558,
                                        3.544877325122379,
                                        2.8012691124248925,
                                        3.1591919161719435,
                                        3.7760785244377253,
                                        2.609947587412134,
                                        3.795010280020125,
                                        3.335410863250152,
                                        2.5424352011321747
                                ]
                        }
                },
                "thermal_treatment": {
                        "id": "thermal_treatment",
                        "name": "Tratamiento T\u00e9rmico",
                        "type": "process",
                        "icon": "fas fa-fire",
                        "status": "warning",
                        "alerts": 4,
                        "personnel": 10,
                        "throughput": 78.20329580818388,
                        "connections": [
                                "cooling",
                                "energy_recovery"
                        ],
                        "position": {
                                "x": 500,
                                "y": 50
                        },
                        "sensors": {
                                "thermal_monitoring": [
                                        {
                                                "id": "TEMP-001",
                                                "type": "Horno Principal",
                                                "value": 937.2690137142174,
                                                "unit": "\u00b0C",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "TEMP-002",
                                                "type": "C\u00e1mara de Enfriamiento",
                                                "value": 185.84625669011422,
                                                "unit": "\u00b0C",
                                                "status": "WARNING"
                                        },
                                        {
                                                "id": "TEMP-003",
                                                "type": "Detector de Fugas T\u00e9rmica",
                                                "value": 6.699820939806554,
                                                "unit": "kW perdidos",
                                                "status": "WARNING"
                                        }
                                ],
                                "gas_monitoring": [
                                        {
                                                "id": "GAS-001",
                                                "type": "Detector CO",
                                                "value": 8.276370364515701,
                                                "unit": "ppm",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "GAS-002",
                                                "type": "Detector NH3",
                                                "value": 2.8278004197976268,
                                                "unit": "ppm",
                                                "status": "CRITICAL"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-130-THERMAL",
                                "subnet": "192.168.130.0/24",
                                "devices": 32,
                                "bandwidth_usage": 72.09077400936165,
                                "security_level": "CRITICAL"
                        },
                        "metrics_data": {
                                "furnace_temperature": [
                                        874.7532159776971,
                                        929.4388463846116,
                                        893.8298119249741,
                                        942.5282338670085,
                                        907.0285739671433,
                                        892.6394184285616,
                                        924.1392741116308,
                                        930.3672694041425,
                                        957.1635372061012,
                                        853.2328007754629,
                                        927.3790925208505,
                                        842.6540108597826,
                                        955.3219856209544,
                                        857.5749621816253,
                                        852.2240845461521,
                                        957.1572264988658,
                                        941.8557730457882,
                                        843.4125017014917,
                                        840.3002698181194,
                                        938.0841847594394,
                                        934.943806043269,
                                        953.2251501368905,
                                        898.2635279324602,
                                        885.7615660779098
                                ],
                                "energy_consumption": [
                                        2959.721710060397,
                                        2843.892582286121,
                                        2809.1429238063133,
                                        3174.3660636204118,
                                        3044.771510686469,
                                        3014.2500433958753,
                                        2811.145010533953,
                                        2994.1409852773486,
                                        3128.158775272549,
                                        2873.942370422577,
                                        3142.608323213686,
                                        3113.2659137629385,
                                        3037.0579717726737,
                                        2959.134544828641,
                                        2837.4657691041652,
                                        2811.2835470620876,
                                        3166.978894050147,
                                        3015.497542413064,
                                        3106.377024942162,
                                        3155.1801814166024,
                                        2954.902838116217,
                                        2822.224001145792,
                                        3044.048045257284,
                                        2832.139428333909
                                ],
                                "thermal_efficiency": [
                                        85.97422707331206,
                                        86.43488608160277,
                                        85.85194449066366,
                                        80.79160304629558,
                                        84.18551071532664,
                                        86.98387098890062,
                                        79.20352394878294,
                                        78.98027701450737,
                                        86.20460344417616,
                                        86.92863721661777,
                                        87.01080678566727,
                                        79.74637767322855,
                                        82.78699218359668,
                                        83.41006160664965,
                                        85.9919776385133,
                                        78.08871742836841,
                                        82.95136860751599,
                                        84.83154171331462,
                                        78.93445818235737,
                                        79.87554690501966,
                                        87.90338528766696,
                                        83.33898635667154,
                                        85.79677243953385,
                                        83.34998492030704
                                ]
                        }
                },
                "power_distribution": {
                        "id": "power_distribution",
                        "name": "Distribuci\u00f3n El\u00e9ctrica",
                        "type": "utility",
                        "icon": "fas fa-bolt",
                        "status": "operational",
                        "alerts": 2,
                        "personnel": 6,
                        "throughput": 94.19049446775671,
                        "connections": [
                                "ups_systems"
                        ],
                        "position": {
                                "x": 800,
                                "y": 250
                        },
                        "sensors": {
                                "electrical_monitoring": [
                                        {
                                                "id": "POW-001",
                                                "type": "L\u00ednea Principal A",
                                                "load": 77.16411305777692,
                                                "unit": "%",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "POW-002",
                                                "type": "L\u00ednea Principal B",
                                                "load": 74.46498312941043,
                                                "unit": "%",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "POW-003",
                                                "type": "L\u00ednea de Emergencia",
                                                "load": 12.545558935194297,
                                                "unit": "%",
                                                "status": "STANDBY"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-200-POWER",
                                "subnet": "192.168.200.0/24",
                                "devices": 28,
                                "bandwidth_usage": 52.3970619854384,
                                "security_level": "CRITICAL"
                        },
                        "metrics_data": {
                                "power_consumption": [
                                        2715.1624759496135,
                                        2894.1434876824587,
                                        2788.346613876168,
                                        3035.460716491538,
                                        2976.8240713327746,
                                        2708.164649192175,
                                        2904.8331655418556,
                                        3308.416249927118,
                                        2830.5467505960364,
                                        2804.0567922785835,
                                        3384.184466615686,
                                        3272.061804520146,
                                        2710.902032058402,
                                        2900.08399919638,
                                        2992.0400730762394,
                                        3176.7530749387324,
                                        2735.8740193169783,
                                        3160.7085397952305,
                                        2720.3410991324313,
                                        2748.005459685637,
                                        3353.959449445997,
                                        3117.075454240922,
                                        3394.19081502206,
                                        2649.7324222787165
                                ],
                                "power_factor": [
                                        0.9023076994754015,
                                        0.9242267262030929,
                                        0.9015519983950485,
                                        0.8830683333270977,
                                        0.9279673640622936,
                                        0.9167848319592953,
                                        0.9500766513125017,
                                        0.9213241851371567,
                                        0.9033587622716495,
                                        0.9452771918308142,
                                        0.8801487128192916,
                                        0.8966415186740839,
                                        0.8981507816138448,
                                        0.9366547345438996,
                                        0.9190338464057137,
                                        0.9091496346652651,
                                        0.8907052281866725,
                                        0.9150896136874852,
                                        0.9231568210852575,
                                        0.9147997298259979,
                                        0.9382984253190261,
                                        0.9471486646446338,
                                        0.8892733548730943,
                                        0.8810373418104686
                                ],
                                "harmonic_distortion": [
                                        5.871972954289603,
                                        5.741819061861303,
                                        6.042032066661115,
                                        5.553745202400236,
                                        3.9465188273063116,
                                        3.7995437282635693,
                                        2.6056307300334556,
                                        2.8272332081073186,
                                        2.7460609319236178,
                                        3.629804576154842,
                                        3.6072426850687513,
                                        4.9881244300346825,
                                        4.342609971470866,
                                        3.8950708104791856,
                                        3.6118142922293144,
                                        3.2342432113412944,
                                        6.7874558509329805,
                                        2.562767699568175,
                                        4.176706577422802,
                                        3.8237445566001105,
                                        2.981544248386352,
                                        2.545299464738152,
                                        4.911410740490819,
                                        5.371261847354948
                                ]
                        }
                },
                "packaging": {
                        "id": "packaging",
                        "name": "Empaquetado",
                        "type": "process",
                        "icon": "fas fa-box",
                        "status": "operational",
                        "alerts": 3,
                        "personnel": 9,
                        "throughput": 92.82637952174412,
                        "connections": [
                                "warehouse"
                        ],
                        "position": {
                                "x": 1100,
                                "y": 100
                        },
                        "sensors": {
                                "production_flow": [
                                        {
                                                "id": "FLOW-001",
                                                "type": "Contador de Productos",
                                                "value": 1875,
                                                "unit": "unid/h",
                                                "status": "NORMAL"
                                        },
                                        {
                                                "id": "FLOW-002",
                                                "type": "Sensor de Atascos",
                                                "events": 2,
                                                "unit": "eventos/h",
                                                "status": "NORMAL"
                                        }
                                ]
                        },
                        "network": {
                                "vlan": "VLAN-150-PACK",
                                "subnet": "192.168.150.0/24",
                                "devices": 38,
                                "bandwidth_usage": 77.59832082576517,
                                "security_level": "HIGH"
                        },
                        "metrics_data": {
                                "packaging_speed": [
                                        2245.4583138239745,
                                        1898.94705178643,
                                        2033.6651960768884,
                                        2045.6953659857036,
                                        1967.988023594546,
                                        1835.965994529476,
                                        1904.5813017543887,
                                        1970.846782671451,
                                        2122.675528518717,
                                        1882.1416785337717,
                                        2271.87671378534,
                                        1990.874437519547,
                                        2285.998148428489,
                                        2211.793971415402,
                                        1816.697942883188,
                                        2086.372901266232,
                                        2156.362781044648,
                                        1831.054531995678,
                                        2179.6686089682266,
                                        1831.1294084344713,
                                        1996.4526113099364,
                                        1955.5154762649245,
                                        1942.219766798741,
                                        1840.4116098784195
                                ],
                                "defect_rate": [
                                        0.6626050254697111,
                                        0.9718409870501914,
                                        2.3981638925120574,
                                        0.5786608619874518,
                                        2.4691633638795665,
                                        2.0766185988384858,
                                        2.0277504235020265,
                                        1.4097402081397885,
                                        1.0148890857767108,
                                        2.1249261542051787,
                                        1.9987557392640158,
                                        1.4621571126187831,
                                        1.1240867571831794,
                                        0.8718165475241325,
                                        2.1369441210683995,
                                        1.7316052027571325,
                                        1.4046689573224764,
                                        2.4629481757955056,
                                        2.130489502203429,
                                        1.278378865636339,
                                        1.4751675665505264,
                                        1.0219399194560288,
                                        0.9906364445549356,
                                        0.8266818047199921
                                ],
                                "efficiency": [
                                        82.58695276358145,
                                        86.24069726762933,
                                        91.6909379356249,
                                        94.58026402596857,
                                        82.38875859040192,
                                        84.96737282660544,
                                        87.62565520025424,
                                        92.33759640266736,
                                        90.05825525613436,
                                        93.49831379703616,
                                        89.57598146556657,
                                        88.6575966249145,
                                        90.18390161774445,
                                        90.5210156268596,
                                        89.63994893272766,
                                        89.03511858521539,
                                        95.29098194243366,
                                        86.01788087793567,
                                        93.76060978029972,
                                        84.15557397287952,
                                        89.68541140875654,
                                        83.29650448935082,
                                        88.47003404226305,
                                        95.23668265319529
                                ]
                        }
                }
        }
};
        let selectedProcess = null;
        let performanceChart = null;
        let realtimeChart = null;

        // Configuración global de gráficos
        Chart.defaults.font.family = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
        Chart.defaults.color = '#ffffff';

        // Función principal para seleccionar proceso
        function selectProcess(processId) {
            // Limpiar selección anterior
            document.querySelectorAll('.process-node').forEach(node => {
                node.classList.remove('selected');
            });

            // Seleccionar nuevo proceso
            selectedProcess = processId;
            const node = document.getElementById('node_' + processId);
            node.classList.add('selected');

            const processData = systemData.process_flow[processId];

            // Actualizar badge
            document.getElementById('selectedProcessBadge').textContent = processData.name;

            // Mostrar secciones de análisis
            showAnalyticsSection(processData);
            showMLESection(processData);
        }

        // Mostrar sección de analytics
        function showAnalyticsSection(processData) {
            document.getElementById('analyticsTitle').innerHTML = `
                <i class="fas fa-chart-line me-2"></i>
                Análisis Detallado: ${processData.name}
            `;

            // Generar KPIs del proceso
            generateProcessKPIs(processData);

            // Generar detalles técnicos
            generateTechnicalDetails(processData);

            // Crear gráficos
            createPerformanceChart(processData);
            createRealtimeChart(processData);

            // Mostrar sección
            document.getElementById('analyticsSection').style.display = 'block';
        }

        // Generar KPIs del proceso
        function generateProcessKPIs(processData) {
            const kpisHtml = `
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-tachometer-alt text-info"></i>
                        </div>
                        <h5 class="text-white">Rendimiento</h5>
                        <h3 class="text-info">${processData.throughput.toFixed(1)}%</h3>
                        <small class="text-light">Eficiencia actual</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-exclamation-triangle text-warning"></i>
                        </div>
                        <h5 class="text-white">Alertas</h5>
                        <h3 class="text-warning">${processData.alerts}</h3>
                        <small class="text-light">Alertas activas</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-users text-success"></i>
                        </div>
                        <h5 class="text-white">Personal</h5>
                        <h3 class="text-success">${processData.personnel}</h3>
                        <small class="text-light">Operadores</small>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="glass-card p-4 text-center metric-card">
                        <div class="display-4 mb-2">
                            <i class="fas fa-network-wired text-purple"></i>
                        </div>
                        <h5 class="text-white">Red</h5>
                        <h3 class="text-purple">${processData.network.devices}</h3>
                        <small class="text-light">Dispositivos</small>
                    </div>
                </div>
            `;
            document.getElementById('processKPIs').innerHTML = kpisHtml;
        }

        // Generar detalles técnicos
        function generateTechnicalDetails(processData) {
            let sensorsHtml = '';
            if (processData.sensors) {
                Object.keys(processData.sensors).forEach(category => {
                    const sensors = processData.sensors[category];
                    const categoryTitle = category.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());

                    sensorsHtml += `
                        <div class="col-md-6 mb-3">
                            <div class="glass-card p-3">
                                <h6 class="text-warning mb-2">${categoryTitle}</h6>`;

                    sensors.forEach(sensor => {
                        const statusClass = sensor.status === 'NORMAL' || sensor.status === 'OPERATIONAL' ? 'success' : 'warning';
                        sensorsHtml += `
                            <div class="d-flex justify-content-between align-items-center mb-2 p-2 bg-dark rounded">
                                <div>
                                    <strong class="text-white">${sensor.id || sensor.type || sensor.parameter}</strong><br>
                                    <small class="text-light">${sensor.type || sensor.parameter || 'Sensor'}</small>
                                </div>
                                <div class="text-end">
                                    <span class="text-white">${sensor.value || sensor.samples_hour || sensor.accuracy || 'N/A'} ${sensor.unit || ''}</span><br>
                                    <span class="badge bg-${statusClass}">${sensor.status}</span>
                                </div>
                            </div>`;
                    });

                    sensorsHtml += '</div></div>';
                });
            }

            // Información de red
            const networkHtml = `
                <div class="col-md-6 mb-3">
                    <div class="glass-card p-3">
                        <h6 class="text-info mb-2">Información de Red</h6>
                        <div class="row">
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">VLAN</strong><br>
                                    <span class="text-white">${processData.network.vlan}</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">Dispositivos</strong><br>
                                    <span class="text-white">${processData.network.devices}</span>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">Subred</strong><br>
                                    <span class="text-white">${processData.network.subnet}</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="p-2 bg-dark rounded text-center">
                                    <strong class="text-info">Uso BW</strong><br>
                                    <span class="text-white">${processData.network.bandwidth_usage.toFixed(1)}%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('technicalDetails').innerHTML = sensorsHtml + networkHtml;
        }

        // Crear gráfico de rendimiento
        function createPerformanceChart(processData) {
            if (performanceChart) {
                performanceChart.destroy();
            }

            const ctx = document.getElementById('performanceChart').getContext('2d');
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);

            let data1, data2, data3;
            if (processData.metrics_data) {
                const metrics = Object.values(processData.metrics_data);
                data1 = metrics[0] || Array.from({length: 24}, () => Math.random() * 20 + 80);
                data2 = metrics[1] || Array.from({length: 24}, () => Math.random() * 20 + 80);
                data3 = metrics[2] || Array.from({length: 24}, () => Math.random() * 20 + 80);
            } else {
                data1 = Array.from({length: 24}, () => Math.random() * 20 + 80);
                data2 = Array.from({length: 24}, () => Math.random() * 20 + 80);
                data3 = Array.from({length: 24}, () => Math.random() * 20 + 80);
            }

            performanceChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: hours,
                    datasets: [{
                        label: 'Métrica 1',
                        data: data1,
                        borderColor: '#4ECDC4',
                        backgroundColor: 'rgba(78, 205, 196, 0.2)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Métrica 2',
                        data: data2,
                        borderColor: '#FF6B6B',
                        backgroundColor: 'rgba(255, 107, 107, 0.2)',
                        fill: true,
                        tension: 0.4
                    }, {
                        label: 'Métrica 3',
                        data: data3,
                        borderColor: '#FFA726',
                        backgroundColor: 'rgba(255, 167, 38, 0.2)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Crear gráfico en tiempo real
        function createRealtimeChart(processData) {
            if (realtimeChart) {
                realtimeChart.destroy();
            }

            const ctx = document.getElementById('realtimeChart').getContext('2d');

            realtimeChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Rendimiento', 'Disponible'],
                    datasets: [{
                        data: [processData.throughput, 100 - processData.throughput],
                        backgroundColor: [
                            '#4ECDC4',
                            'rgba(255, 255, 255, 0.1)'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    }
                }
            });
        }

        // Mostrar sección MLE
        function showMLESection(processData) {
            document.getElementById('mleSection').style.display = 'block';

            // Placeholder para recomendaciones
            document.getElementById('mleRecommendations').innerHTML = `
                <div class="text-center text-light p-4">
                    <i class="fas fa-robot fa-3x mb-3 text-info"></i>
                    <h6>MLE Star listo para analizar: ${processData.name}</h6>
                    <p>Haga click en "Ejecutar Análisis" para obtener recomendaciones específicas</p>
                </div>
            `;
        }

        // Ejecutar análisis MLE
        function runMLEAnalysis() {
            if (!selectedProcess) return;

            const processData = systemData.process_flow[selectedProcess];

            // Simular análisis (en producción vendría del backend)
            const recommendations = generateMLERecommendations(processData);

            let html = '';
            recommendations.forEach((rec, index) => {
                html += `
                    <div class="mle-recommendation severity-${rec.severity.toLowerCase()}">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h6 class="text-white">${rec.title}</h6>
                            <span class="badge bg-${rec.severity.toLowerCase()}">${rec.severity}</span>
                        </div>
                        <p class="text-light mb-3">${rec.description}</p>

                        <h6 class="text-warning mb-2">Acciones Recomendadas:</h6>
                        <ul class="text-light">`;

                rec.actions.forEach(action => {
                    html += `<li>${action}</li>`;
                });

                html += `</ul>

                        <div class="row mt-3">
                            <div class="col-md-6">
                                <h6 class="text-info mb-2">Detalles Técnicos:</h6>`;

                Object.keys(rec.technical_details).forEach(key => {
                    html += `<small class="text-light d-block">${key.replace('_', ' ')}: <strong>${rec.technical_details[key]}</strong></small>`;
                });

                html += `
                            </div>
                            <div class="col-md-6 text-end">
                                <button class="btn btn-success btn-sm me-2" onclick="implementRecommendation(${index})">
                                    <i class="fas fa-play me-1"></i>Implementar
                                </button>
                                <button class="btn btn-info btn-sm" onclick="scheduleRecommendation(${index})">
                                    <i class="fas fa-calendar me-1"></i>Programar
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('mleRecommendations').innerHTML = html;
        }

        // Generar recomendaciones MLE (simplificado)
        function generateMLERecommendations(processData) {
            const recommendations = [];

            if (processData.throughput < 90) {
                recommendations.push({
                    title: 'Optimización de Rendimiento',
                    description: `Rendimiento actual de ${processData.throughput.toFixed(1)}% está por debajo del objetivo`,
                    severity: processData.throughput < 80 ? 'HIGH' : 'MEDIUM',
                    actions: [
                        'Analizar cuellos de botella en el proceso',
                        'Implementar control predictivo avanzado',
                        'Optimizar parámetros de operación'
                    ],
                    technical_details: {
                        'rendimiento_actual': processData.throughput.toFixed(1) + '%',
                        'objetivo': '95%+',
                        'mejora_potencial': (95 - processData.throughput).toFixed(1) + '%'
                    }
                });
            }

            if (processData.alerts > 2) {
                recommendations.push({
                    title: 'Reducción de Alertas',
                    description: `${processData.alerts} alertas activas requieren atención`,
                    severity: 'HIGH',
                    actions: [
                        'Investigar causas raíz de alertas recurrentes',
                        'Ajustar umbrales de alarma',
                        'Implementar mantenimiento preventivo'
                    ],
                    technical_details: {
                        'alertas_actuales': processData.alerts,
                        'objetivo': '< 2',
                        'reduccion_requerida': Math.max(0, processData.alerts - 2)
                    }
                });
            }

            if (processData.network.bandwidth_usage > 70) {
                recommendations.push({
                    title: 'Optimización de Red',
                    description: `Uso de ancho de banda del ${processData.network.bandwidth_usage.toFixed(1)}% es elevado`,
                    severity: 'MEDIUM',
                    actions: [
                        'Implementar Quality of Service (QoS)',
                        'Optimizar protocolos de comunicación',
                        'Revisar tráfico no esencial'
                    ],
                    technical_details: {
                        'uso_actual': processData.network.bandwidth_usage.toFixed(1) + '%',
                        'objetivo': '< 70%',
                        'dispositivos': processData.network.devices
                    }
                });
            }

            return recommendations;
        }

        // Funciones de acción
        function implementRecommendation(index) {
            alert(`✅ Implementando recomendación #${index + 1}\n\nSe creará ticket de trabajo automáticamente.`);
        }

        function scheduleRecommendation(index) {
            const date = prompt('Ingrese fecha para programar (YYYY-MM-DD):');
            if (date) {
                alert(`📅 Recomendación #${index + 1} programada para ${date}`);
            }
        }

        console.log('🚀 SmartCompute Dashboard Híbrido iniciado');
        console.log('📊 Procesos disponibles:', Object.keys(systemData.process_flow).length);
    </script>
</body>
</html>